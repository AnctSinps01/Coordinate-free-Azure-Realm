using UnityEngine;

public class MapRiverGenerate : MonoBehaviour
{
    public readonly int[,] MappingTable =
    {
        {  0,  0}, {  0,  0}, {  2,  0}, {  3,  0}, {  0,  0}, {  0,  0}, {  3,  4}, {  7,  0}, 
        {  2,  3}, {  3,  5}, { 10,  0}, { 11,  0}, {  2,  3}, {  3,  5}, { 42,  5}, { 43,  5}, 
        {  2,  1}, {  2,  1}, { 10,  1}, { 42,  1}, {  3,  1}, {  3,  1}, { 11,  1}, { 43,  1}, 
        { 66,  1}, { 67,  5}, { 74,  1}, { 75,  5}, { 67,  1}, { 99,  1}, { 75,  1}, {107,  1}, 
        {  0,  0}, {  0,  0}, {  2,  0}, {  3,  0}, {  0,  0}, {  0,  0}, {  3,  4}, {  7,  0}, 
        {  3,  3}, {  7,  3}, { 42,  0}, { 43,  0}, {  3,  3}, {  7,  3}, { 46,  0}, { 47,  0}, 
        {  2,  1}, {  2,  1}, { 10,  1}, { 42,  1}, {  3,  1}, {  3,  1}, { 11,  1}, { 43,  1}, 
        { 67,  3}, { 71,  3}, { 78,  5}, { 87,  3}, {195,  1}, {227,  1}, {211,  3}, {215,  3}, 
        {  2,  2}, {  2,  2}, { 66,  0}, { 67,  0}, {  2,  2}, {  2,  2}, { 67,  4}, { 71,  0}, 
        { 10,  3}, { 42,  6}, { 74,  0}, { 75,  0}, { 10,  3}, { 42,  6}, { 78,  0}, { 87,  4}, 
        { 10,  2}, { 10,  2}, { 74,  2}, { 78,  4}, { 42,  2}, { 42,  2}, { 75,  4}, { 87,  0}, 
        { 74,  3}, { 78,  3}, { 90,  0}, { 91,  0}, { 78,  7}, {115,  1}, { 91,  1}, {123,  1}, 
        {  3,  6}, {  3,  6}, { 67,  6}, { 99,  0}, {  3,  6}, {  3,  6}, {195,  4}, {227,  6}, 
        { 11,  3}, { 43,  6}, { 75,  6}, {107,  0}, { 11,  3}, { 43,  6}, {211,  4}, {215,  4}, 
        { 42,  7}, { 42,  7}, { 78,  2}, {115,  0}, { 46,  2}, { 46,  2}, {211,  6}, {119,  0}, 
        { 75,  3}, { 87,  5}, { 91,  3}, {123,  0}, {211,  1}, {119,  5}, {219,  1}, {127,  0}, 
        {  0,  0}, {  0,  0}, {  2,  0}, {  3,  0}, {  0,  0}, {  0,  0}, {  3,  4}, {  7,  0}, 
        {  2,  3}, {  3,  5}, { 10,  0}, { 11,  0}, {  2,  3}, {  3,  5}, { 42,  5}, { 43,  5}, 
        {  3,  7}, {  3,  7}, { 42,  4}, { 46,  1}, {  7,  1}, {  7,  1}, { 43,  4}, { 47,  1}, 
        { 67,  7}, {195,  5}, { 78,  1}, {211,  7}, { 71,  1}, {227,  5}, { 87,  7}, {215,  7}, 
        {  0,  0}, {  0,  0}, {  2,  0}, {  3,  0}, {  0,  0}, {  0,  0}, {  3,  4}, {  7,  0}, 
        {  3,  3}, {  7,  3}, { 42,  0}, { 43,  0}, {  3,  3}, {  7,  3}, { 46,  0}, { 47,  0}, 
        {  3,  7}, {  3,  7}, { 42,  4}, { 46,  1}, {  7,  1}, {  7,  1}, { 43,  4}, { 47,  1}, 
        { 99,  3}, {227,  7}, {115,  3}, {119,  3}, {227,  3}, {231,  1}, {119,  7}, {247,  3}, 
        {  3,  2}, {  3,  2}, { 67,  2}, {195,  0}, {  3,  2}, {  3,  2}, { 99,  2}, {227,  2}, 
        { 42,  3}, { 46,  3}, { 78,  6}, {211,  2}, { 42,  3}, { 46,  3}, {115,  2}, {119,  4}, 
        { 11,  2}, { 11,  2}, { 75,  2}, {211,  0}, { 43,  2}, { 43,  2}, {107,  2}, {215,  0}, 
        { 75,  7}, {211,  5}, { 91,  2}, {219,  0}, { 87,  1}, {119,  1}, {123,  2}, {127,  1}, 
        {  7,  2}, {  7,  2}, { 71,  2}, {227,  0}, {  7,  2}, {  7,  2}, {227,  4}, {231,  0}, 
        { 43,  3}, { 47,  3}, { 87,  2}, {215,  2}, { 43,  3}, { 47,  3}, {119,  2}, {247,  2}, 
        { 43,  7}, { 43,  7}, { 87,  6}, {119,  6}, { 47,  2}, { 47,  2}, {215,  6}, {247,  0}, 
        {107,  3}, {215,  5}, {123,  3}, {127,  3}, {215,  1}, {247,  1}, {127,  2}, {255,  0}
    };

    public GameObject[] RiverTilePrefabs;

    
    void Start()
    {
        for (int i = 0; i < 33; i++) {
            RiverTilePrefabs[i] = Resources.Load<GameObject>("Assets/Prefabs/RiverTiles/RiverTile_" + i);
        }

        GenerateMap();
    }

    void Update()
    {
        GenerateMap();
    }
    
    void GenerateMap()
    {
        
    }


    public void PlaceTile(int x, int y, int tileID, int transType)
    {
        Vector3 position = new Vector3(x, y, 0);
        
        GameObject tile = Instantiate(RiverTilePrefabs[tileID], position, Quaternion.identity);
        tile.transform.SetParent(transform);
        tile.name = $"Tile_{x}_{y}";

        // 应用变换
        bool isFlipped = transType >= 4;
        float rotationAngle = (transType % 4) * 90f;

        // 设置缩放实现镜像 (注意：这会影响所有子物体)
        tile.transform.localScale = new Vector3(isFlipped ? -1f : 1f, 1f, 1f);

        // 设置旋转
        tile.transform.localRotation = Quaternion.Euler(0, 0, rotationAngle);
    }

}

